$(document).on("click",".mibok-modal-timetable",function(){var p=$(this).parents(".element-item");var n=$(this);var i=$("input[name=TIMETABLE_AJAX]").val();var k=$("input[name=FIELD_CODE_MODAL]").val();var a=$("input[name=PROPERTY_CODE_MODAL]").val();var h=$("input[name=IBLOCK_ID_TIMETABLE]").val();var d=$("input[name=IBLOCK_TYPE_TIMETABLE]").val();var e=$("input[name=LIST_SETTINGS_MODAL_NAME]").val();var l=$("input[name=MODAL_DATA]").val();var f=p.find("input[name=TIME_INFO]").val();var g=$("input[name=PROPERTY_CODES_RECORD]").val();var o=$("input[name=PROPERTY_CODES_RECORD_REQUIRED]").val();var c=$("input[name=RECORD_PARAM]").val();var j=$("input[name=IS_RECORD]").val();var m=$("input[name=CONSENT]").val();var b=p.attr("data-id");$.ajax({type:"POST",url:i,async:false,data:{ELEMENT_ID:b,FIELD:k,IBLOCK_ID:h,IBLOCK_TYPE:d,PROPERTY:a,MODAL_NAME:e,TIME_INFO:f,MODAL_DATA:l,PROP_RECORD:g,PROP_RECORD_REQ:o,RECORD_PARAM:c,IS_RECORD:j,CONSENT:m,SPECIAL:"Y"},success:function(q){p.find(".button-mibok-timetable").html(q)}});n.attr("disabled");n.addClass("disabled");return false}).on("input",".button-mibok-timetable form[name=iblock_add] input[type=text]",function(){MibokCheckSubmit()}).on("change","#iblock_consent",function(){if($("input#iblock_consent:checked").length<=0){$(".mibok-form-submit").attr("disabled","disabled")}else{MibokCheckSubmit()}}).on("input",".button-mibok-timetable form[name=iblock_add] textarea",function(){MibokCheckSubmit()});function MibokCheckSubmit(){var a=$(".button-mibok-timetable form[name=iblock_add] *[data-req]").length;var b=0;$(".button-mibok-timetable form[name=iblock_add] *[data-req]").each(function(d,c){if($(c).val()!=""){b++}});if($("input#iblock_consent").length>0){if(b==a&&$("input#iblock_consent:checked").length>0){$(".mibok-form-submit").removeAttr("disabled")}else{$(".mibok-form-submit").attr("disabled","disabled")}}else{if(b==a){$(".mibok-form-submit").removeAttr("disabled")}else{$(".mibok-form-submit").attr("disabled","disabled")}}}$(document).ready(function(){if($(".element-item").length>0){var a=$(".element-item .count-rasp").length;if($(".count-rasp").length>0){var b=new Object;var g=$("input[name=IBLOCK_ID_TIMETABLE]").val();var h=$("input[name=TIMETABLE_AJAX]").val();$(".count-rasp").each(function(o){var n=$(this).parents(".element-item");var l=n.attr("data-id");var p=n.find("input[name=TIME_INFO]").val();var m=$(this);b[o]={ELEMENT_ID:l,TIME_INFO:p}});$.ajax({type:"POST",url:h,dataType:"json",data:{ITEMS:b,IBLOCK_ID:g,ACTION:"GetLimit"},success:function(n){for(var m in n){var l=$('.count-rasp[data-rasp-id="'+n[m]["id"]+'"]');if(l.length>0){l.addClass(n[m]["class"]).html(n[m]["table"]+"/"+n[m]["iblock"]);if(n[m]["class"]=="no-item-record"){l.addClass("glyphicon glyphicon-ban-circle")}}}}})}}if($("#datepicker").length>0){var j="left";if($("body ").width()<768){j="right"}var e=$("#datepicker input[name=minDate]").val();var i=$("#datepicker input[name=dateLimit]").val();var c=$("#datepicker input[name=period_begin]").val();var f=$("#datepicker input[name=period_end]").val();var d=$("#datepicker input[name=dayList]").val().split(",");var k=$("#datepicker input[name=monthList]").val().split(",");$("#datepicker").daterangepicker({inline:true,autoApply:true,opens:j,startDate:c,endDate:f,minDate:e,dateLimit:{days:i},locale:{format:"DD.MM.YYYY",separator:",",daysOfWeek:d,monthNames:k,firstDay:1,},});$("#datepicker").on("apply.daterangepicker",function(m,l){$("#datepicker input[name=period_begin]").val(l.startDate.format("DD.MM.YYYY"));$("#datepicker input[name=period_end]").val(l.endDate.format("DD.MM.YYYY"));$("#datepicker input[name=period_begin_end]").val(l.startDate.format("DD.MM.YYYY")+" - "+l.endDate.format("DD.MM.YYYY"))})}});